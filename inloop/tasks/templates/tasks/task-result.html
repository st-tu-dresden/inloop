{% extends 'base_site.html' %}
{% load staticfiles %}

{% block title %}{{ task.title }}{% endblock %}

{% block content %}
    <div class="row">
    <div class="col-md-10 col-md-offset-1">
        <h1>{{task.title}} Results</h1>
        <br />
        {% if solution.passed %}
        <div class="panel panel-success">
                <div class="panel-heading">
                    Checker Results
                </div>
                <div class="panel-body">
                    <span class="glyphicon glyphicon-ok-sign big-icon-green" aria-hidden="true"></span>
                    <span class="status-text-success">PASSED</span>
                    <br>
                    <pre class="topbot">{{ result }}</pre>
                </div>
        </div>
        {% else %}
        <div class="panel panel-danger">
                <div class="panel-heading">
                    Checker Results
                </div>
                <div class="panel-body">
                    <span class="glyphicon glyphicon-remove-sign big-icon-red" aria-hidden="true"></span>
                    <span class="status-text-failed">FAILED</span>
                    <br>
                    <pre class="topbot">{{ result }}</pre>
                </div>
        </div>
        {% endif %}
        <div role="tabpanel">
            <!-- nav tabs -->
            {% if solution_files %}
            <ul class="nav nav-tabs" role="tablist">
                {% for fname in solution_files.keys %}
                    {% if forloop.first %}
                    <li role="presentation" class="active">
                        <a href="#{{ forloop.counter }}"
                           role="tab"
                           data-toggle="tab">{{ fname|escape }}
                        </a>
                    </li>
                    {% else %}
                    <li role="presentation">
                        <a href="#{{ forloop.counter }}"
                           role="tab"
                           data-toggle="tab">{{ fname|escape }}
                        </a>
                    </li>
                    {% endif %}
                {% endfor %}
            </ul>
            {% endif %}

            <!-- tab panes -->
            <div class="tab-content">
                {% for fname, content in solution_files.items %}
                    {% if forloop.first %}
                        <div role="tabpanel" class="tab-pane active" id="{{ forloop.counter }}">
                            <div class="noselection" id="editor{{ forloop.counter }}">{{ content|escape }}</div>
                        </div>
                    {% else %}
                        <div role="tabpanel" class="tab-pane" id="{{ forloop.counter }}">
                            <div class="noselection" id="editor{{ forloop.counter }}">{{ content|escape }}</div>
                        </div>
                    {% endif %}
                {% empty %}
                    <p>This solution does not contain any files.</p>
                {% endfor %}
            </div>
        </div>
    </div>
    </div>
{% endblock %}

{% block extrabody %}
<script src="{% static 'js/ace.min.js' %}"></script>
<script src="{% static 'js/inloop.min.js' %}"></script>
<script type="text/javascript">
    {% for fname in solution_files.keys %}
        var editor{{ forloop.counter }} = ace.edit("editor{{ forloop.counter }}");
        editor{{ forloop.counter }}.getSession().setMode("ace/mode/java");
        editor{{ forloop.counter }}.setOptions({
            readOnly: true,
            highlightActiveLine: false,
            highlightGutterLine: false
        });
    {% endfor %}
</script>
{% endblock %}
